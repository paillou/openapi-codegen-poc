openapi: 3.0.0
info:
  version: 1.0.0
  title: BlaBlaCar APIs
  contact:
    name: Edge
    url: https://bitbucket.corp.blablacar.com/projects/SERVICES/repos/edge-api/browse/api-contracts
    email: squad-edge@blablacar.com
paths:
  /booking:
    get:
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/BookingResponse"
components:
  schemas:
    BookingResponse:
      type: object
      properties:
        steps:
          type: array
          items:
            $ref: "#/components/schemas/Step"
        flow_id:
          type: string
          format: uuid
          description: This flow identifier is generated by the client application and embedded in the first request to Edge. It will be then added in each subsequent requests and responses of the booking flow.

    Step:
      type: object
      required:
        - name
      properties:
        name:
          type: string
      discriminator:
        propertyName: name
        mapping:
          LOGIN: "#/components/schemas/LoginStep"
          PHONE_CERTIFY: "#/components/schemas/PhoneCertifyStep"

    LoginStep:
      allOf:
        - $ref: '#/components/schemas/Step'
        - title: Login
          description: This step requires the client to redirect the user to the login flow. After a successful login, the client should resume the booking flow by validating this step with the backend.
          type: object
          required:
            - context
          properties:
            context:
              type: object
              required:
                - p1
                - p2
              properties:
                p1:
                  type: string
                p2:
                  type: integer

    PhoneCertifyStep:
      allOf:
        - $ref: '#/components/schemas/Step'
        - title: PhoneCertify
          type: object
          description: This step requires the client to redirect the user to the phone number certification flow. The client should then resume the booking flow by validating this step with the backend.
          required:
            - version
          properties:
            version:
              type: number